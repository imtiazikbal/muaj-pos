/*! For license information please see StoreOrders.2a30b65139e1129a.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8189],{31326:(t,e,r)=>{r.d(e,{A:()=>o});var n=r(76314),a=r.n(n)()(function(t){return t[1]});a.push([t.id,".wrapper[data-v-2c64b7f1]{overflow:visible}",""]);const o=a},37593:(t,e,r)=>{r.r(e),r.d(e,{default:()=>m});function n(){var t,e,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.toStringTag||"@@toStringTag";function i(r,n,o,s){var i=n&&n.prototype instanceof l?n:l,u=Object.create(i.prototype);return a(u,"_invoke",function(r,n,a){var o,s,i,l=0,u=a||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,r){return o=e,s=0,i=t,f.n=r,c}};function p(r,n){for(s=r,i=n,e=0;!d&&l&&!a&&e<u.length;e++){var a,o=u[e],p=f.p,h=o[2];r>3?(a=h===n)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=p&&((a=r<2&&p<o[1])?(s=0,f.v=n,f.n=o[1]):p<h&&(a=r<3||o[0]>n||n>h)&&(o[4]=r,o[5]=n,f.n=h,s=0))}if(a||r>1)return c;throw d=!0,n}return function(a,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),s=u,i=h;(e=s<2?t:i)||!d;){o||(s?s<3?(s>1&&(f.n=-1),p(s,i)):f.n=i:f.v=i);try{if(l=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(d=f.n<0)?i:r.call(n,f))!==c)break}catch(e){o=t,s=1,i=e}finally{l=1}}return{value:e,done:d}}}(r,o,s),!0),u}var c={};function l(){}function u(){}function d(){}e=Object.getPrototypeOf;var f=[][o]?e(e([][o]())):(a(e={},o,function(){return this}),e),p=d.prototype=l.prototype=Object.create(f);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,s,"GeneratorFunction")),t.prototype=Object.create(p),t}return u.prototype=d,a(p,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,s,"GeneratorFunction"),a(p),a(p,s,"Generator"),a(p,o,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:h}})()}function a(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,r,n){function s(e,r){a(t,e,function(t){return this._invoke(e,r,t)})}e?o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(s("next",0),s("throw",1),s("return",2))},a(t,e,r,n)}function o(t,e,r,n,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(n,a)}function s(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var s=t.apply(e,r);function i(t){o(s,n,a,i,c,"next",t)}function c(t){o(s,n,a,i,c,"throw",t)}i(void 0)})}}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach(function(e){u(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function u(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==i(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const d={metaInfo:{title:"Store Orders"},data:function(){return{isLoading:!0,rows:[],totalRows:0,errorTitle:"",errors:[],search:"",status:"",dateFrom:null,dateTo:null,actionBusyId:null,statusOptions:[{value:"",text:this.$t("All_Status")},{value:"pending",text:this.$t("pending")},{value:"confirmed",text:this.$t("confirmed")},{value:"cancelled",text:this.$t("cancelled")}],columns:[{label:this.$t("Order"),field:"code",sortable:!0},{label:this.$t("Customer"),field:"customer_name",sortable:!0},{label:this.$t("Status"),field:"status",sortable:!0},{label:this.$t("Total"),field:"total",sortable:!0,type:"number"},{label:this.$t("Date"),field:"created_at",sortable:!0},{label:this.$t("Actions"),field:"actions"}],serverParams:{page:1,perPage:10,sort:[{field:"created_at",type:"desc"}]}}},mounted:function(){this.fetch()},computed:l(l({},(0,r(95353).L8)(["currentUser"])),{},{hasError:function(){return this.errorTitle&&this.errorTitle.length||this.errors.length>0}}),methods:{currency:function(t){var e=this.currentUser.currency;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:e}).format(t||0)}catch(r){return e+" "+Number(t||0).toFixed(2)}},badgeVariant:function(t){return{pending:"warning",confirmed:"success",cancelled:"danger"}[t]||"secondary"},toDateStr:function(t){if(!t)return"";var e=t instanceof Date?t:new Date(t);return isNaN(e.getTime())?"":e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)},_headers:function(){var t={Accept:"application/json"},e=document.querySelector('meta[name="csrf-token"]');return e&&e.content&&(t["X-CSRF-TOKEN"]=e.content),t},_postPatch:function(t,e){var r=e||{};return r._method="PATCH",axios.post(t,r,{headers:this._headers(),withCredentials:!0,validateStatus:function(){return!0}})},clearErrors:function(){this.errorTitle="",this.errors=[]},setErrorState:function(t,e){this.errorTitle=t||"",this.errors=Array.isArray(e)?e:[]},_flattenErrors:function(t){var e=[];if(!t)return e;if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]&&e.push(String(t[r]));else if("object"===i(t))for(var n=Object.keys(t),a=0;a<n.length;a++){var o=t[n[a]];if(Array.isArray(o))for(var s=0;s<o.length;s++)o[s]?e.push(String(o[s])):o&&e.push(String(o))}else"string"==typeof t&&e.push(t);for(var c={},l=[],u=0;u<e.length;u++){var d=String(e[u]).trim();d&&!c[d]&&(c[d]=1,l.push(d))}return l},_parseItems:function(t){var e=[];if(Array.isArray(t))for(var r=0;r<t.length;r++){var n=t[r]||{},a=n.name?n.name:"#"+(void 0!==n.product_id?n.product_id:""),o=void 0!==n.required?n.required:"-",s=void 0!==n.available?n.available:"-";e.push(a+": Required "+o+" â€” Available "+s)}return e},_stripHtml:function(t){try{return String(t).replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim()}catch(e){return String(t)}},_parsePayloadToState:function(t){var e="",r=[];if(!t)return{title:"",list:[]};if("string"==typeof t){var n=this._stripHtml(t);return n&&"validation failed"!==n.toLowerCase()&&(e=n),{title:e,list:[]}}if(t.errors)return{title:e="string"==typeof t.message&&"validation failed"!==t.message.toLowerCase()?this._stripHtml(t.message):e||this.$t("Validation_failed")||"Validation failed",list:r=this._flattenErrors(t.errors)};if("string"==typeof t.error&&t.error.trim()&&(e=t.error.trim()),t.items&&(r=this._parseItems(t.items)),!r.length&&Array.isArray(t.messages))for(var a=0;a<t.messages.length;a++)t.messages[a]&&r.push(String(t.messages[a]));if(!r.length&&t.details)if(Array.isArray(t.details))for(var o=0;o<t.details.length;o++)t.details[o]&&r.push(String(t.details[o]));else"string"==typeof t.details&&r.push(t.details);if(!e&&"string"==typeof t.message){var s=this._stripHtml(t.message);"validation failed"!==s.toLowerCase()&&(e=s)}for(var i={},c=[],l=0;l<r.length;l++){var u=String(r[l]).trim();u&&!i[u]&&(i[u]=1,c.push(u))}return{title:e,list:c}},_asErrorState:function(t){var e=t&&t.status?t.status:0,r=t&&t.data?t.data:null,n=r&&(r.errors||r.items||"string"==typeof r.error&&r.error.trim()||!1===r.status||!1===r.ok);return 0===e?{title:this.$t("Network_error")||"Network error",list:[]}:n||e>=400?this._parsePayloadToState(r):{title:"",list:[]}},fetch:function(){var t=this;return s(n().m(function e(){var r,a,o,s,i;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return t.isLoading=!0,t.clearErrors(),e.p=1,r=t.serverParams.sort&&t.serverParams.sort[0]?t.serverParams.sort[0]:null,a={page:t.serverParams.page,per_page:t.serverParams.perPage,sort:r?r.field:"created_at",dir:r?r.type:"desc",q:t.search||"",status:t.status||"",from:t.toDateStr(t.dateFrom),to:t.toDateStr(t.dateTo)},e.n=2,axios.get("/store/orders",{params:a,headers:t._headers(),withCredentials:!0,validateStatus:function(){return!0}});case 2:o=e.v,(s=t._asErrorState(o)).title||s.list.length?t.setErrorState(s.title,s.list):(i=o&&o.data?o.data:{},t.rows=i.data||i.rows||[],t.totalRows=i.meta&&i.meta.total?i.meta.total:t.rows.length),e.n=4;break;case 3:e.p=3,e.v,t.setErrorState(t.$t("Network_error")||"Network error",[]);case 4:return e.p=4,t.isLoading=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}))()},reload:function(){this.serverParams.page=1,this.fetch()},onPageChange:function(t){this.serverParams.page=t&&t.currentPage?t.currentPage:1,this.fetch()},onPerPageChange:function(t){this.serverParams.perPage=t&&t.currentPerPage?t.currentPerPage:10,this.fetch()},onSortChange:function(t){this.serverParams.sort=t&&t[0]?[t[0]]:[],this.fetch()},clearFilters:function(){this.search="",this.status="",this.dateFrom=null,this.dateTo=null,this.clearErrors(),this.reload()},confirmOrder:function(t){var e=this;return s(n().m(function r(){var a,o,s,i;return n().w(function(r){for(;;)switch(r.p=r.n){case 0:if(t&&"pending"===t.status){r.n=1;break}return r.a(2);case 1:if(a=!0,!e.$swal){r.n=3;break}return r.n=2,e.$swal({title:e.$t("Confirm_this_order_Q")||"Confirm this order?",text:e.$t("Confirm_to_sale_hint")||"",icon:"warning",showCancelButton:!0,confirmButtonText:e.$t("Confirm")||"Confirm",cancelButtonText:e.$t("Cancel")||"Cancel"});case 2:o=r.v,a=!(!o||!o.isConfirmed&&!0!==o.value);case 3:if(a){r.n=4;break}return r.a(2);case 4:return e.actionBusyId=t.id,r.p=5,r.n=6,e._postPatch("/store/orders/"+t.id,{status:"confirmed"});case 6:if(s=r.v,!(i=e._asErrorState(s)).title&&!i.list.length){r.n=7;break}return e.setErrorState(i.title,i.list),r.a(2);case 7:t.status="confirmed",e.clearErrors(),e.$bvToast?e.$bvToast.toast(e.$t("Order_confirmed")||"Order confirmed.",{title:e.$t("Success")||"Success",variant:"success",solid:!0}):e.$swal&&e.$swal({icon:"success",title:e.$t("Success")||"Success",text:e.$t("Order_confirmed")||"Order confirmed."}),r.n=9;break;case 8:r.p=8,r.v,e.setErrorState(e.$t("Network_error")||"Network error",[]);case 9:return r.p=9,e.actionBusyId=null,r.f(9);case 10:return r.a(2)}},r,null,[[5,8,9,10]])}))()},cancelOrder:function(t){var e=this;return s(n().m(function r(){var a,o,s,i;return n().w(function(r){for(;;)switch(r.p=r.n){case 0:if(t&&"pending"===t.status){r.n=1;break}return r.a(2);case 1:if(a=!0,!e.$swal){r.n=3;break}return r.n=2,e.$swal({title:e.$t("Cancel_this_order_Q")||"Cancel this order?",text:e.$t("Cancel_order_hint")||"",icon:"warning",showCancelButton:!0,confirmButtonText:e.$t("Cancel")||"Cancel",cancelButtonText:e.$t("Keep")||"Keep"});case 2:o=r.v,a=!(!o||!o.isConfirmed&&!0!==o.value);case 3:if(a){r.n=4;break}return r.a(2);case 4:return e.actionBusyId=t.id,r.p=5,r.n=6,e._postPatch("/store/orders/"+t.id,{status:"cancelled"});case 6:if(s=r.v,!(i=e._asErrorState(s)).title&&!i.list.length){r.n=7;break}return e.setErrorState(i.title,i.list),r.a(2);case 7:t.status="cancelled",e.clearErrors(),e.$bvToast?e.$bvToast.toast(e.$t("Order_cancelled")||"Order cancelled.",{title:e.$t("Success")||"Success",variant:"success",solid:!0}):e.$swal&&e.$swal({icon:"success",title:e.$t("Success")||"Success",text:e.$t("Order_cancelled")||"Order cancelled."}),r.n=9;break;case 8:r.p=8,r.v,e.setErrorState(e.$t("Network_error")||"Network error",[]);case 9:return r.p=9,e.actionBusyId=null,r.f(9);case 10:return r.a(2)}},r,null,[[5,8,9,10]])}))()}}};var f=r(85072),p=r.n(f),h=r(31326),v={insert:"head",singleton:!1};p()(h.A,v);h.A.locals;const m=(0,r(14486).A)(d,function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content"},[e("breadcumb",{attrs:{page:t.$t("Orders"),folder:t.$t("Store")}}),t._v(" "),t.isLoading?e("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):e("b-card",{staticClass:"wrapper"},[e("b-alert",{staticClass:"mb-3",attrs:{variant:"danger",show:t.hasError,dismissible:""},on:{dismissed:t.clearErrors}},[t.errorTitle?e("div",{staticClass:"font-weight-bold mb-2"},[t._v("\n        "+t._s(t.errorTitle)+"\n      ")]):t._e(),t._v(" "),t.errors.length?e("ul",{staticClass:"mb-0 pl-3"},t._l(t.errors,function(r,n){return e("li",{key:n},[t._v(t._s(r))])}),0):t._e()]),t._v(" "),e("div",{staticClass:"row mb-3"},[e("div",{staticClass:"col-md-3"},[e("b-form-input",{attrs:{placeholder:t.$t("Search")},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.reload.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t._v(" "),e("div",{staticClass:"col-md-3"},[e("b-form-select",{attrs:{options:t.statusOptions},on:{change:t.reload},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1),t._v(" "),e("div",{staticClass:"col-md-3"},[e("b-form-datepicker",{attrs:{placeholder:t.$t("From")},on:{input:t.reload},model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}})],1),t._v(" "),e("div",{staticClass:"col-md-3"},[e("b-form-datepicker",{attrs:{placeholder:t.$t("To")},on:{input:t.reload},model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}})],1)]),t._v(" "),e("vue-good-table",{attrs:{mode:"remote",columns:t.columns,rows:t.rows,totalRows:t.totalRows,"pagination-options":{enabled:!0,perPage:t.serverParams.perPage},"search-options":{enabled:!1},styleClass:"table-hover tableOne vgt-table"},on:{"on-page-change":t.onPageChange,"on-per-page-change":t.onPerPageChange,"on-sort-change":t.onSortChange},scopedSlots:t._u([{key:"table-row",fn:function(r){return["status"===r.column.field?e("span",[e("b-badge",{attrs:{variant:t.badgeVariant(r.row.status)}},[t._v(t._s(r.row.status))])],1):"total"===r.column.field?e("span",[t._v("\n          "+t._s(t.currency(r.row.total))+"\n        ")]):"actions"===r.column.field?e("span",[e("div",{staticClass:"btn-group btn-group-sm"},["pending"===r.row.status?[e("b-button",{attrs:{disabled:t.actionBusyId===r.row.id,variant:"outline-success"},on:{click:function(e){return t.confirmOrder(r.row)}}},[t.actionBusyId===r.row.id?e("span",{staticClass:"spinner-border spinner-border-sm"}):e("span",[t._v(t._s(t.$t("Confirm")))])]),t._v(" "),e("b-button",{attrs:{disabled:t.actionBusyId===r.row.id,variant:"outline-danger"},on:{click:function(e){return t.cancelOrder(r.row)}}},[t.actionBusyId===r.row.id?e("span",{staticClass:"spinner-border spinner-border-sm"}):e("span",[t._v(t._s(t.$t("Cancel")))])])]:t._e(),t._v(" "),e("router-link",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"btn btn-outline-primary btn-sm",attrs:{to:{name:"StoreOrderShow",params:{id:r.row.id}},title:t.$t("Details")}},[e("i",{staticClass:"i-Eye"})])],2)]):e("span",[t._v("\n          "+t._s(r.formattedRow[r.column.field])+"\n        ")])]}}])},[e("div",{staticClass:"mt-2 mb-3",attrs:{slot:"table-actions"},slot:"table-actions"},[e("b-button",{staticClass:"btn-rounded",attrs:{size:"sm",variant:"btn btn-outline-secondary"},on:{click:t.clearFilters}},[e("i",{staticClass:"i-Reload"}),t._v(" "+t._s(t.$t("Clear"))+"\n        ")])],1)])],1)],1)},[],!1,null,"2c64b7f1",null).exports},76314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=t(e);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r}).join("")},e.i=function(t,r,n){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(n)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(a[s]=!0)}for(var i=0;i<t.length;i++){var c=[].concat(t[i]);n&&a[c[0]]||(r&&(c[2]?c[2]="".concat(r," and ").concat(c[2]):c[2]=r),e.push(c))}},e}},85072:(t,e,r)=>{var n,a=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},o=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),s=[];function i(t){for(var e=-1,r=0;r<s.length;r++)if(s[r].identifier===t){e=r;break}return e}function c(t,e){for(var r={},n=[],a=0;a<t.length;a++){var o=t[a],c=e.base?o[0]+e.base:o[0],l=r[c]||0,u="".concat(c," ").concat(l);r[c]=l+1;var d=i(u),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(s[d].references++,s[d].updater(f)):s.push({identifier:u,updater:m(f,e),references:1}),n.push(u)}return n}function l(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var a=r.nc;a&&(n.nonce=a)}if(Object.keys(n).forEach(function(t){e.setAttribute(t,n[t])}),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var u,d=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function f(t,e,r,n){var a=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=d(e,a);else{var o=document.createTextNode(a),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function p(t,e,r){var n=r.css,a=r.media,o=r.sourceMap;if(a?t.setAttribute("media",a):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var h=null,v=0;function m(t,e){var r,n,a;if(e.singleton){var o=v++;r=h||(h=l(e)),n=f.bind(null,r,o,!1),a=f.bind(null,r,o,!0)}else r=l(e),n=p.bind(null,r,e),a=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else a()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=a());var r=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<r.length;n++){var a=i(r[n]);s[a].references--}for(var o=c(t,e),l=0;l<r.length;l++){var u=i(r[l]);0===s[u].references&&(s[u].updater(),s.splice(u,1))}r=o}}}}}]);