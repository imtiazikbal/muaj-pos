/*! For license information please see StoreOrderShow.2a30b65139e1129a.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6593],{98452:(t,e,r)=>{r.r(e),r.d(e,{default:()=>f});var n=r(95353);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,s){var i=n&&n.prototype instanceof u?n:u,l=Object.create(i.prototype);return a(l,"_invoke",function(r,n,o){var s,a,i,u=0,l=o||[],d=!1,f={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return s=e,a=0,i=t,f.n=r,c}};function v(r,n){for(a=r,i=n,e=0;!d&&u&&!o&&e<l.length;e++){var o,s=l[e],v=f.p,p=s[2];r>3?(o=p===n)&&(i=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=t):s[0]<=v&&((o=r<2&&v<s[1])?(a=0,f.v=n,f.n=s[1]):v<p&&(o=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,f.n=p,a=0))}if(o||r>1)return c;throw d=!0,n}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&v(l,p),a=l,i=p;(e=a<2?t:i)||!d;){s||(a?a<3?(a>1&&(f.n=-1),v(a,i)):f.n=i:f.v=i);try{if(u=2,s){if(a||(o="next"),e=s[o]){if(!(e=e.call(s,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,a<2&&(a=0)}else 1===a&&(e=s.return)&&e.call(s),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);s=t}else if((e=(d=f.n<0)?i:r.call(n,f))!==c)break}catch(e){s=t,a=1,i=e}finally{u=1}}return{value:e,done:d}}}(r,o,s),!0),l}var c={};function u(){}function l(){}function d(){}e=Object.getPrototypeOf;var f=[][n]?e(e([][n]())):(a(e={},n,function(){return this}),e),v=d.prototype=u.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,o,"GeneratorFunction")),t.prototype=Object.create(v),t}return l.prototype=d,a(v,"constructor",d),a(d,"constructor",l),l.displayName="GeneratorFunction",a(d,o,"GeneratorFunction"),a(v),a(v,o,"Generator"),a(v,n,function(){return this}),a(v,"toString",function(){return"[object Generator]"}),(s=function(){return{w:i,m:p}})()}function a(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,r,n){function s(e,r){a(t,e,function(t){return this._invoke(e,r,t)})}e?o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(s("next",0),s("throw",1),s("return",2))},a(t,e,r,n)}function i(t,e,r,n,o,s,a){try{var i=t[s](a),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(n,o)}function c(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var s=t.apply(e,r);function a(t){i(s,n,o,a,c,"next",t)}function c(t){i(s,n,o,a,c,"throw",t)}a(void 0)})}}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function l(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const d={metaInfo:{title:"Store Order"},props:{id:{type:[String,Number],required:!0}},data:function(){return{loading:!0,actionBusy:!1,order:{items:[],status:"pending"},code:""}},mounted:function(){this.fetch()},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},(0,n.L8)(["currentUser"])),methods:{currency:function(t){var e=this.currentUser.currency;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:e}).format(t||0)}catch(r){return e+" "+Number(t||0).toFixed(2)}},badgeVariant:function(t){return{pending:"warning",confirmed:"success",cancelled:"danger"}[t]||"secondary"},fetch:function(){var t=this;return c(s().m(function e(){var r,n;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,axios.get("/store/orders/".concat(t.id));case 1:r=e.v,n=r.data,t.order=n||{items:[],status:"pending"},t.code=n&&(n.code||"#".concat(n.id));case 2:return e.p=2,t.loading=!1,e.f(2);case 3:return e.a(2)}},e,null,[[0,,2,3]])}))()},confirmOrder:function(){var t=this;this.order&&"pending"===this.order.status&&this.$swal({title:"Confirm this order?",text:"This will convert the online order into a Sale and deduct stock.",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancel",confirmButtonText:"Confirm"}).then(function(){var e=c(s().m(function e(r){var n,o,a,i,c,u,l;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.value){e.n=1;break}return e.a(2);case 1:return window.NProgress&&(NProgress.start(),NProgress.set(.1)),t.actionBusy=!0,e.p=2,e.n=3,axios.patch("/store/orders/".concat(t.id),{status:"confirmed"});case 3:n=e.v,o=n.data,t.order.status="confirmed",a=o&&o.sale_ref?"Order confirmed as Sale ".concat(o.sale_ref):"Order confirmed",t.$swal("Success",a,"success"),e.n=5;break;case 4:e.p=4,l=e.v,i="Operation failed. Please try again.",(c=l&&l.response&&l.response.data)&&(Array.isArray(c.items)&&c.items.length?(u=c.items.map(function(t){return"".concat(t.name," â€” 'Available': ").concat(t.available,", 'Required': ").concat(t.required)}),i="Insufficient stock for:\n"+u.join("\n")):(c.error||c.message)&&(i=c.error||c.message)),t.$swal("Error",i,"warning");case 5:return e.p=5,t.actionBusy=!1,window.NProgress&&setTimeout(function(){return NProgress.done()},300),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(t){return e.apply(this,arguments)}}())},cancelOrder:function(){var t=this;this.order&&"pending"===this.order.status&&this.$swal({title:"Cancel this order?",text:"This will mark the order as cancelled.",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Keep",confirmButtonText:"Cancel"}).then(function(){var e=c(s().m(function e(r){return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r.value){e.n=1;break}return e.a(2);case 1:return window.NProgress&&(NProgress.start(),NProgress.set(.1)),t.actionBusy=!0,e.p=2,e.n=3,axios.patch("/store/orders/".concat(t.id),{status:"cancelled"});case 3:t.order.status="cancelled",t.$swal("Success","Order cancelled","success"),e.n=5;break;case 4:e.p=4,e.v,t.$swal("Error","Operation failed. Please try again.","warning");case 5:return e.p=5,t.actionBusy=!1,window.NProgress&&setTimeout(function(){return NProgress.done()},300),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(t){return e.apply(this,arguments)}}())},toast:function(t,e,r){this.$bvToast&&this.$bvToast.toast?this.$bvToast.toast(r,{title:e,variant:t,autoHideDelay:3e3,solid:!0}):"danger"===t?alert((e||"Error")+": "+r):console.log(e+": "+r)}}};const f=(0,r(14486).A)(d,function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content"},[e("breadcumb",{attrs:{page:t.$t("Order"),folder:t.$t("Store")}}),t._v(" "),t.loading?e("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):e("b-card",{staticClass:"wrapper"},[e("div",{staticClass:"d-flex justify-content-between align-items-center mb-3"},[e("h5",{staticClass:"mb-0"},[t._v(t._s(t.code))]),t._v(" "),e("div",{staticClass:"d-flex align-items-center"},[e("b-badge",{staticClass:"mr-2 text-uppercase",attrs:{variant:t.badgeVariant(t.order.status)}},[t._v("\n          "+t._s(t.order.status)+"\n        ")])],1)]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-7"},[e("b-card",{staticClass:"mb-3"},[e("h6",{staticClass:"mb-3"},[t._v(t._s(t.$t("Items")))]),t._v(" "),e("div",{staticClass:"table-responsive"},[e("table",{staticClass:"table table-sm"},[e("thead",[e("tr",[e("th",[t._v(t._s(t.$t("Product")))]),t._v(" "),e("th",[t._v(t._s(t.$t("Qty")))]),t._v(" "),e("th",[t._v(t._s(t.$t("Price")))]),t._v(" "),e("th",{staticClass:"text-right"},[t._v(t._s(t.$t("Total")))])])]),t._v(" "),e("tbody",t._l(t.order.items,function(r){return e("tr",{key:r.id},[e("td",[t._v(t._s(r.name))]),t._v(" "),e("td",[t._v(t._s(r.qty))]),t._v(" "),e("td",[t._v(t._s(t.currency(r.price)))]),t._v(" "),e("td",{staticClass:"text-right"},[t._v(t._s(t.currency(r.price*r.qty)))])])}),0)])])])],1),t._v(" "),e("div",{staticClass:"col-md-5"},[e("b-card",{staticClass:"mb-3"},[e("h6",[t._v("Customer")]),t._v(" "),e("div",{staticClass:"text-muted"},[t._v(t._s(t.order.customer_name))]),t._v(" "),e("div",{staticClass:"text-muted"},[t._v(t._s(t.order.customer_email))]),t._v(" "),e("div",{staticClass:"text-muted"},[t._v(t._s(t.order.customer_phone))])]),t._v(" "),e("b-card",{staticClass:"mb-3"},[e("h6",[t._v(t._s(t.$t("Shipping")))]),t._v(" "),e("div",{staticClass:"text-muted"},[t._v(t._s(t.order.customer_phone||"-"))]),t._v(" "),e("div",{staticClass:"text-muted"},[t._v(t._s(t.order.customer_address||"-"))])]),t._v(" "),e("b-card",{staticClass:"mb-3"},[e("h6",[t._v("Warehouse")]),t._v(" "),e("div",{staticClass:"text-muted"},[t._v("\n            "+t._s(t.order.warehouse_name||"-")+"\n          ")])]),t._v(" "),e("b-card",{staticClass:"mb-3"},[e("h6",[t._v("Summary")]),t._v(" "),e("ul",{staticClass:"list-unstyled mb-0"},[e("li",{staticClass:"d-flex justify-content-between"},[e("span",[t._v("Subtotal")]),t._v(" "),e("strong",[t._v(t._s(t.currency(t.order.subtotal)))])]),t._v(" "),Number(t.order.shipping||0)>0?e("li",{staticClass:"d-flex justify-content-between"},[e("span",[t._v("Shipping")]),t._v(" "),e("strong",[t._v(t._s(t.currency(t.order.shipping||0)))])]):t._e(),t._v(" "),Number(t.order.discount||0)>0?e("li",{staticClass:"d-flex justify-content-between"},[e("span",[t._v("Discount")]),t._v(" "),e("strong",[t._v("-"+t._s(t.currency(t.order.discount||0)))])]):t._e(),t._v(" "),e("li",{staticClass:"d-flex justify-content-between border-top pt-2"},[e("span",[t._v("Total")]),t._v(" "),e("strong",[t._v(t._s(t.currency(t.order.total)))])])])])],1)])])],1)},[],!1,null,null,null).exports}}]);