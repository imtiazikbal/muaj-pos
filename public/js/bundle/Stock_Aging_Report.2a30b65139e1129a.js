/*! For license information please see Stock_Aging_Report.2a30b65139e1129a.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9707],{64010:(t,e,n)=>{n.r(e),n.d(e,{default:()=>h});var r=n(5947),a=n.n(r);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var s=r&&r.prototype instanceof l?r:l,u=Object.create(s.prototype);return i(u,"_invoke",function(n,r,a){var o,s,i,l=0,u=a||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return o=e,s=0,i=t,d.n=n,c}};function p(n,r){for(s=n,i=r,e=0;!f&&l&&!a&&e<u.length;e++){var a,o=u[e],p=d.p,h=o[2];n>3?(a=h===r)&&(i=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=t):o[0]<=p&&((a=n<2&&p<o[1])?(s=0,d.v=r,d.n=o[1]):p<h&&(a=n<3||o[0]>r||r>h)&&(o[4]=n,o[5]=r,d.n=h,s=0))}if(a||n>1)return c;throw f=!0,r}return function(a,u,h){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&p(u,h),s=u,i=h;(e=s<2?t:i)||!f;){o||(s?s<3?(s>1&&(d.n=-1),p(s,i)):d.n=i:d.v=i);try{if(l=2,o){if(s||(a="next"),e=o[a]){if(!(e=e.call(o,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,s<2&&(s=0)}else 1===s&&(e=o.return)&&e.call(o),s<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),s=1);o=t}else if((e=(f=d.n<0)?i:n.call(r,d))!==c)break}catch(e){o=t,s=1,i=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),u}var c={};function l(){}function u(){}function f(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(i(e={},r,function(){return this}),e),p=f.prototype=l.prototype=Object.create(d);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,i(t,a,"GeneratorFunction")),t.prototype=Object.create(p),t}return u.prototype=f,i(p,"constructor",f),i(f,"constructor",u),u.displayName="GeneratorFunction",i(f,a,"GeneratorFunction"),i(p),i(p,a,"Generator"),i(p,r,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:o,m:h}})()}function i(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}i=function(t,e,n,r){function o(e,n){i(t,e,function(t){return this._invoke(e,n,t)})}e?a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},i(t,e,n,r)}function c(t,e,n,r,a,o,s){try{var i=t[o](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(r,a)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function s(t){c(o,r,a,s,i,"next",t)}function i(t){c(o,r,a,s,i,"throw",t)}s(void 0)})}}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach(function(e){d(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function d(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const p={metaInfo:{title:"Stock Aging Report"},data:function(){return{isLoading:!0,serverParams:{sort:{field:"age_days",type:"desc"},page:1,perPage:10},limit:"10",search:"",totalRows:0,rows:[],dimension:"product",dimensionOptions:[{value:"product",text:"By Product"},{value:"variant",text:"By Variant"}],buckets:[30,60,90],bucketsInput:"30,60,90",warehouse_id:null,brand_id:null,category_id:null,warehouseOptions:[{value:null,text:this.$t("All")}],brandOptions:[{value:null,text:this.$t("All")}],categoryOptions:[{value:null,text:this.$t("All")}]}},computed:f(f({},(0,n(95353).L8)(["currentUser"])),{},{columns:function(){var t=[{label:this.$t("Code"),field:"code",sortable:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Product"),field:"product_name",sortable:!0,tdClass:"text-left",thClass:"text-left"}];return"variant"===this.dimension&&t.push({label:this.$t("Variant"),field:"variant_name",sortable:!0,tdClass:"text-left",thClass:"text-left"}),t.push({label:this.$t("OnHand"),field:"on_hand",type:"number",sortable:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("LastInbound"),field:"last_inbound_at",sortable:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("AgeDays"),field:"age_days",type:"number",sortable:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Bucket"),field:"age_bucket",sortable:!0,tdClass:"text-left",thClass:"text-left"}),t}}),methods:{formatAgeDays:function(t){var e=Number(t);return isNaN(e)?"—":Math.floor(e)},fetchFilters:function(){var t=this;return l(s().m(function e(){var n,r,a;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,axios.get("report/stock_aging/filters");case 1:n=e.v,r=n.data,a={value:null,text:t.$t("All")},t.warehouseOptions=[a].concat((r.warehouses||[]).map(function(t){return{value:Number(t.id),text:String(t.name)}})),t.brandOptions=[a].concat((r.brands||[]).map(function(t){return{value:Number(t.id),text:String(t.name)}})),t.categoryOptions=[a].concat((r.categories||[]).map(function(t){return{value:Number(t.id),text:String(t.name)}})),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}))()},bucketVariant:function(t){return t?t.includes("0–")?"success":t.includes("31–")||t.includes("30–")?"info":t.includes("61–")?"warning":"danger":"secondary"},updateParams:function(t){this.serverParams=Object.assign({},this.serverParams,t)},onPageChange:function(t){var e=t.currentPage;this.serverParams.page!==e&&(this.updateParams({page:e}),this.fetch(e))},onPerPageChange:function(t){var e=t.currentPerPage;this.limit!==e&&(this.limit=e.toString(),this.updateParams({page:1,perPage:e}),this.fetch(1))},onSortChange:function(t){t&&t[0]&&(this.updateParams({sort:{type:t[0].type,field:t[0].field}}),this.fetch(this.serverParams.page))},onSearch:function(t){this.search=t.searchTerm||"",this.fetch(this.serverParams.page)},onDimensionChange:function(){"variant_name"===this.serverParams.sort.field&&"variant"!==this.dimension&&(this.serverParams.sort.field="product_name"),this.updateParams({page:1}),this.fetch(1)},onBucketsChange:function(){var t=(this.bucketsInput||"").split(",").map(function(t){return parseInt(String(t).trim(),10)}).filter(function(t){return!isNaN(t)&&t>0}).sort(function(t,e){return t-e});this.buckets=t.length?t:[30,60,90],this.bucketsInput=this.buckets.join(","),this.refresh()},refresh:function(){this.updateParams({page:1}),this.fetch(1)},fetch:function(t){var e=this;a().start(),a().set(.1);var n="page="+t+"&SortField="+encodeURIComponent(this.serverParams.sort.field)+"&SortType="+encodeURIComponent(this.serverParams.sort.type)+"&search="+encodeURIComponent(this.search||"")+"&limit="+encodeURIComponent(this.limit)+"&dimension="+encodeURIComponent(this.dimension)+"&buckets="+encodeURIComponent(this.buckets.join(","))+(null!=this.warehouse_id?"&warehouse_id="+encodeURIComponent(this.warehouse_id):"")+(null!=this.brand_id?"&brand_id="+encodeURIComponent(this.brand_id):"")+(null!=this.category_id?"&category_id="+encodeURIComponent(this.category_id):"");axios.get("report/stock_aging?"+n).then(function(t){var n=t.data,r=Array.isArray(n.report)?n.report:[];e.totalRows=Number(n.totalRows||0),e.rows=r,a().done(),e.isLoading=!1}).catch(function(){a().done(),setTimeout(function(){e.isLoading=!1},400)})},init:function(){var t=this;return l(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:return t.isLoading=!0,e.n=1,t.fetchFilters();case 1:t.fetch(1);case 2:return e.a(2)}},e)}))()}},created:function(){this.init()}};const h=(0,n(14486).A)(p,function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content"},[e("breadcumb",{attrs:{page:t.$t("Stock_Aging_Report"),folder:t.$t("Reports")}}),t._v(" "),t.isLoading?e("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):t._e(),t._v(" "),t.isLoading?t._e():e("b-card",{staticClass:"wrapper"},[e("div",{staticClass:"d-flex flex-wrap align-items-center mb-3"},[e("div",{staticClass:"mr-3 mb-2"},[e("label",{staticClass:"mb-0 mr-2"},[t._v(t._s(t.$t("Dimension"))+":")]),t._v(" "),e("b-form-select",{staticClass:"w-auto",attrs:{options:t.dimensionOptions,size:"sm"},on:{change:t.onDimensionChange},model:{value:t.dimension,callback:function(e){t.dimension=e},expression:"dimension"}})],1),t._v(" "),e("div",{staticClass:"mr-3 mb-2"},[e("label",{staticClass:"mb-0 mr-2"},[t._v(t._s(t.$t("warehouse"))+":")]),t._v(" "),e("b-form-select",{staticClass:"w-auto",attrs:{options:t.warehouseOptions,size:"sm"},on:{change:t.refresh},model:{value:t.warehouse_id,callback:function(e){t.warehouse_id=e},expression:"warehouse_id"}})],1),t._v(" "),e("div",{staticClass:"mr-3 mb-2"},[e("label",{staticClass:"mb-0 mr-2"},[t._v(t._s(t.$t("Buckets"))+":")]),t._v(" "),e("b-form-input",{staticClass:"w-auto",attrs:{size:"sm",placeholder:t.$t("e.g. 30,60,90")},on:{change:t.onBucketsChange},model:{value:t.bucketsInput,callback:function(e){t.bucketsInput=e},expression:"bucketsInput"}}),t._v(" "),e("small",{staticClass:"text-muted d-block",staticStyle:{"margin-top":"0px"}},[t._v("\n          "+t._s(t.$t("Comma_separated_cutoffs_default"))+": 30,60,90\n        ")])],1),t._v(" "),e("div",{staticClass:"mr-3 mb-2"},[e("label",{staticClass:"mb-0 mr-2"},[t._v(t._s(t.$t("Brand"))+":")]),t._v(" "),e("b-form-select",{staticClass:"w-auto",attrs:{options:t.brandOptions,size:"sm"},on:{change:t.refresh},model:{value:t.brand_id,callback:function(e){t.brand_id=e},expression:"brand_id"}})],1),t._v(" "),e("div",{staticClass:"mr-3 mb-2"},[e("label",{staticClass:"mb-0 mr-2"},[t._v(t._s(t.$t("Category"))+":")]),t._v(" "),e("b-form-select",{staticClass:"w-auto",attrs:{options:t.categoryOptions,size:"sm"},on:{change:t.refresh},model:{value:t.category_id,callback:function(e){t.category_id=e},expression:"category_id"}})],1)]),t._v(" "),e("vue-good-table",{attrs:{mode:"remote",columns:t.columns,totalRows:t.totalRows,rows:t.rows,"search-options":{placeholder:t.$t("Search_this_table"),enabled:!0},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"tableOne table-hover vgt-table mt-3"},on:{"on-page-change":t.onPageChange,"on-per-page-change":t.onPerPageChange,"on-sort-change":t.onSortChange,"on-search":t.onSearch},scopedSlots:t._u([{key:"table-row",fn:function(n){return["last_inbound_at"===n.column.field?e("span",[t._v("\n          "+t._s(n.row.last_inbound_at||"—")+"\n        ")]):"age_bucket"===n.column.field?e("span",[e("b-badge",{attrs:{variant:t.bucketVariant(n.row.age_bucket)}},[t._v(t._s(n.row.age_bucket||"—"))])],1):"age_days"===n.column.field?e("span",[t._v("\n          "+t._s(t.formatAgeDays(n.row.age_days))+"\n        ")]):e("span",[t._v("\n          "+t._s(n.formattedRow[n.column.field])+"\n        ")])]}}],null,!1,3760987666)})],1)],1)},[],!1,null,null,null).exports}}]);